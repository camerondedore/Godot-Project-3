[gd_scene load_steps=45 format=3 uid="uid://vic2gqv1xhp2"]

[ext_resource type="Script" uid="uid://1mm28ll82ysf" path="res://C#/NpcMobile/NpcMobile.cs" id="1_164ud"]
[ext_resource type="PackedScene" uid="uid://dx2s20sg0k15w" path="res://Models/character-wynn.glb" id="1_jff1p"]
[ext_resource type="Material" uid="uid://bjcflxq43ap6e" path="res://Materials/Characters/CharacterWynn.tres" id="2_7jj0c"]
[ext_resource type="PackedScene" uid="uid://dabnky0qnlvgu" path="res://Prefabs/CharacterFootsteps.tscn" id="2_eyfap"]
[ext_resource type="Material" uid="uid://ciltja578e1dk" path="res://Materials/Characters/EyeHare.tres" id="3_1ou5g"]
[ext_resource type="Material" uid="uid://byq34v3fjbgtb" path="res://Materials/Characters/Eyelash.tres" id="4_iaey1"]
[ext_resource type="PackedScene" uid="uid://cq0tn2qmf50ap" path="res://Prefabs/CharacterWaterArea.tscn" id="6_fyx4p"]
[ext_resource type="Script" uid="uid://csfcp3vr6xx8c" path="res://C#/NpcDialogue/NpcDialogue.cs" id="8_kl1hr"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_4sxix"]
radius = 0.3

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_06cgn"]
animation = &"wynn-give"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fte0n"]
animation = &"wynn-talk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_v4ymv"]
animation = &"wynn-idle"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_312p8"]
filter_enabled = true
filters = ["character-armature/Skeleton3D:cheek-l", "character-armature/Skeleton3D:cheek-r", "character-armature/Skeleton3D:eye-lid-l", "character-armature/Skeleton3D:eye-lid-r", "character-armature/Skeleton3D:head", "character-armature/Skeleton3D:jaw"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_ab8v0"]
nodes/Animation/node = SubResource("AnimationNodeAnimation_v4ymv")
nodes/Animation/position = Vector2(156, 95)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_fte0n")
"nodes/Animation 2/position" = Vector2(173, 255)
nodes/Blend/node = SubResource("AnimationNodeBlend2_312p8")
nodes/Blend/position = Vector2(420, 140)
nodes/output/position = Vector2(680, 160)
node_connections = [&"Blend", 0, &"Animation", &"Blend", 1, &"Animation 2", &"output", 0, &"Blend"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lrc6m"]
animation = &"wynn-talk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_0fjqx"]
animation = &"wynn-kitchen-chopping"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_ah7mo"]
filter_enabled = true
filters = ["character-armature/Skeleton3D:cheek-l", "character-armature/Skeleton3D:cheek-r", "character-armature/Skeleton3D:eye-lid-l", "character-armature/Skeleton3D:eye-lid-r", "character-armature/Skeleton3D:jaw"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_14mjy"]
graph_offset = Vector2(-308, 33)
nodes/Animation/node = SubResource("AnimationNodeAnimation_0fjqx")
nodes/Animation/position = Vector2(-120, 40)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_lrc6m")
"nodes/Animation 2/position" = Vector2(-100, 200)
nodes/Blend/node = SubResource("AnimationNodeBlend2_ah7mo")
nodes/Blend/position = Vector2(140, 100)
node_connections = [&"Blend", 0, &"Animation", &"Blend", 1, &"Animation 2", &"output", 0, &"Blend"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_iar33"]
animation = &"wynn-talk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_l2lu1"]
animation = &"wynn-kitchen-stirring"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_5olyb"]
filter_enabled = true
filters = ["character-armature/Skeleton3D:cheek-l", "character-armature/Skeleton3D:cheek-r", "character-armature/Skeleton3D:eye-lid-l", "character-armature/Skeleton3D:eye-lid-r", "character-armature/Skeleton3D:jaw"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_ta382"]
nodes/Animation/node = SubResource("AnimationNodeAnimation_l2lu1")
nodes/Animation/position = Vector2(220, 100)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_iar33")
"nodes/Animation 2/position" = Vector2(240, 280)
nodes/Blend/node = SubResource("AnimationNodeBlend2_5olyb")
nodes/Blend/position = Vector2(520, 120)
nodes/output/position = Vector2(720, 180)
node_connections = [&"Blend", 0, &"Animation", &"Blend", 1, &"Animation 2", &"output", 0, &"Blend"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_rnlqg"]
animation = &"wynn-talk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_lsirg"]
animation = &"wynn-run"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_664vy"]
filter_enabled = true
filters = ["character-armature/Skeleton3D:cheek-l", "character-armature/Skeleton3D:cheek-r", "character-armature/Skeleton3D:eye-lid-l", "character-armature/Skeleton3D:eye-lid-r", "character-armature/Skeleton3D:jaw"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_yac63"]
graph_offset = Vector2(10.1, 66.8)
nodes/Animation/node = SubResource("AnimationNodeAnimation_lsirg")
nodes/Animation/position = Vector2(300, 60)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_rnlqg")
"nodes/Animation 2/position" = Vector2(300, 220)
nodes/Blend/node = SubResource("AnimationNodeBlend2_664vy")
nodes/Blend/position = Vector2(480, 119)
nodes/output/position = Vector2(700, 100)
node_connections = [&"Blend", 0, &"Animation", &"Blend", 1, &"Animation 2", &"output", 0, &"Blend"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_pknfw"]
animation = &"wynn-talk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_7ohrd"]
animation = &"wynn-walk"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_cwr0y"]
filter_enabled = true
filters = ["character-armature/Skeleton3D:cheek-l", "character-armature/Skeleton3D:cheek-r", "character-armature/Skeleton3D:eye-lid-l", "character-armature/Skeleton3D:eye-lid-r", "character-armature/Skeleton3D:jaw"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_ai034"]
nodes/Animation/node = SubResource("AnimationNodeAnimation_7ohrd")
nodes/Animation/position = Vector2(155, 180)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_pknfw")
"nodes/Animation 2/position" = Vector2(210, 334)
nodes/Blend/node = SubResource("AnimationNodeBlend2_cwr0y")
nodes/Blend/position = Vector2(404, 320)
nodes/output/position = Vector2(600, 260)
node_connections = [&"Blend", 0, &"Animation", &"Blend", 1, &"Animation 2", &"output", 0, &"Blend"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_vsxsh"]
animation = &"wynn-wave"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_i66mx"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_u8kye"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5kdt3"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_3vfrg"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ng0se"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_4b7ov"]
xfade_time = 0.2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_42uv8"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_dg18n"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_venpl"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_4jq56"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_2irtt"]
xfade_time = 0.1

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_7l30x"]
states/Start/position = Vector2(235, 221)
states/wynn-give/node = SubResource("AnimationNodeAnimation_06cgn")
states/wynn-give/position = Vector2(458, 462)
states/wynn-idle/node = SubResource("AnimationNodeBlendTree_ab8v0")
states/wynn-idle/position = Vector2(393, 221)
states/wynn-kitchen-chopping/node = SubResource("AnimationNodeBlendTree_14mjy")
states/wynn-kitchen-chopping/position = Vector2(744, 92)
states/wynn-kitchen-stirring/node = SubResource("AnimationNodeBlendTree_ta382")
states/wynn-kitchen-stirring/position = Vector2(662, 207)
states/wynn-run/node = SubResource("AnimationNodeBlendTree_yac63")
states/wynn-run/position = Vector2(818, 312)
states/wynn-walk/node = SubResource("AnimationNodeBlendTree_ai034")
states/wynn-walk/position = Vector2(662, 388)
states/wynn-wave/node = SubResource("AnimationNodeAnimation_vsxsh")
states/wynn-wave/position = Vector2(565, 474)
transitions = ["Start", "wynn-idle", SubResource("AnimationNodeStateMachineTransition_i66mx"), "wynn-idle", "wynn-kitchen-stirring", SubResource("AnimationNodeStateMachineTransition_u8kye"), "wynn-idle", "wynn-kitchen-chopping", SubResource("AnimationNodeStateMachineTransition_5kdt3"), "wynn-run", "wynn-idle", SubResource("AnimationNodeStateMachineTransition_3vfrg"), "wynn-kitchen-stirring", "wynn-run", SubResource("AnimationNodeStateMachineTransition_ng0se"), "wynn-kitchen-chopping", "wynn-run", SubResource("AnimationNodeStateMachineTransition_4b7ov"), "wynn-idle", "wynn-run", SubResource("AnimationNodeStateMachineTransition_42uv8"), "wynn-kitchen-stirring", "wynn-walk", SubResource("AnimationNodeStateMachineTransition_dg18n"), "wynn-kitchen-chopping", "wynn-walk", SubResource("AnimationNodeStateMachineTransition_venpl"), "wynn-idle", "wynn-walk", SubResource("AnimationNodeStateMachineTransition_4jq56"), "wynn-walk", "wynn-idle", SubResource("AnimationNodeStateMachineTransition_2irtt")]
graph_offset = Vector2(61, -7)

[sub_resource type="SphereShape3D" id="SphereShape3D_jrfpl"]
radius = 1.0

[node name="NpcMobileWynn" type="CharacterBody3D" node_paths=PackedStringArray("targets")]
collision_layer = 2
floor_max_angle = 0.523599
script = ExtResource("1_164ud")
targets = []
walkAnimationTreeNodeName = "wynn-walk"
turnAnimationTreeNodeName = "wynn-walk"
animationTalkingBlends = PackedStringArray("parameters/wynn-kitchen-chopping/Blend/blend_amount", "parameters/wynn-kitchen-stirring/Blend/blend_amount", "parameters/wynn-run/Blend/blend_amount", "parameters/wynn-idle/Blend/blend_amount", "parameters/wynn-walk/Blend/blend_amount")
speed = 2.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_4sxix")

[node name="NavAgent" type="NavigationAgent3D" parent="."]
path_desired_distance = 0.5
target_desired_distance = 0.25
path_height_offset = -0.5
avoidance_enabled = true
height = 1.5
neighbor_distance = 5.0
max_neighbors = 5
use_3d_avoidance = true

[node name="character-wynn" parent="." instance=ExtResource("1_jff1p")]

[node name="Skeleton3D" parent="character-wynn/character-armature" index="0"]
bones/1/position = Vector3(-0.231238, -1.16561, -1.7458e-08)
bones/1/rotation = Quaternion(0.00909527, 0.706341, -0.0171136, 0.707606)
bones/2/rotation = Quaternion(0.393295, 0.130004, -0.118065, 0.902485)
bones/3/rotation = Quaternion(-0.649597, -0.0727283, 0.0405278, 0.755706)
bones/4/rotation = Quaternion(0.620018, -0.0162772, 0.0115123, 0.784334)
bones/5/rotation = Quaternion(0.383541, 0.0281276, 0.00971793, 0.923044)
bones/6/rotation = Quaternion(0.947565, 0.00672559, 0.00101725, 0.319491)
bones/7/rotation = Quaternion(0.129477, -6.8368e-07, -2.27031e-07, 0.991582)
bones/8/rotation = Quaternion(-0.00821843, -1.2046e-10, 4.5567e-09, 0.999966)
bones/9/rotation = Quaternion(-0.594268, -0.00689208, 0.00441557, 0.804225)
bones/10/position = Vector3(7.27751e-12, 0.137893, -0.0853964)
bones/10/rotation = Quaternion(-0.17941, 3.7975e-10, 1.25536e-10, 0.983774)
bones/11/position = Vector3(0.0699644, 0.19036, 0.0841363)
bones/11/rotation = Quaternion(0.0151432, -0.0178382, 0.0377372, 0.999014)
bones/12/position = Vector3(0.0765538, 0.017639, 0.197477)
bones/12/rotation = Quaternion(0.77304, 0.160358, -0.0294578, 0.613047)
bones/13/position = Vector3(0.0726042, 0.263714, -0.127745)
bones/16/rotation = Quaternion(-0.5, -0.5, 0.5, -0.5)
bones/16/scale = Vector3(1, 1, 1)
bones/17/position = Vector3(-0.0699644, 0.19036, 0.0841363)
bones/17/rotation = Quaternion(0.0151432, -0.0178382, 0.0377372, 0.999014)
bones/18/position = Vector3(-0.0765539, 0.017639, 0.197477)
bones/18/rotation = Quaternion(0.77304, -0.160358, 0.0294579, 0.613047)
bones/19/position = Vector3(-0.0726042, 0.263714, -0.127745)
bones/21/scale = Vector3(1, 1, 1)
bones/22/rotation = Quaternion(-0.583751, -0.0218, -0.59285, 0.554336)
bones/23/rotation = Quaternion(-0.529928, -0.694669, -0.0691869, 0.481482)
bones/24/rotation = Quaternion(0.417349, -0.0697214, 0.0935695, 0.901223)
bones/25/rotation = Quaternion(0.123268, 0.339771, -0.0869336, 0.928334)
bones/26/rotation = Quaternion(-0.284619, 0.0307835, 0.00210748, 0.958144)
bones/27/rotation = Quaternion(-0.583461, 0.0221709, 0.592691, 0.554796)
bones/28/rotation = Quaternion(-0.526414, 0.672918, 0.0597771, 0.516234)
bones/29/rotation = Quaternion(0.393971, 0.0705663, -0.0883282, 0.912143)
bones/30/rotation = Quaternion(0.0493014, -0.334716, 0.0380948, 0.940257)
bones/31/rotation = Quaternion(-0.181084, -0.030833, 0.00117898, 0.982983)
bones/32/rotation = Quaternion(0.37097, -0.107132, 0.142707, 0.911339)
bones/33/rotation = Quaternion(-0.659634, 0.0728647, -0.041753, 0.74688)
bones/34/rotation = Quaternion(0.630086, 0.0168444, -0.0126287, 0.77624)
bones/35/rotation = Quaternion(0.408069, -0.0326821, -0.0393777, 0.911516)
bones/36/rotation = Quaternion(0.948863, 8.2857e-05, 0.000147975, -0.315687)
bones/37/rotation = Quaternion(0.0737874, 0.633564, -0.194133, 0.745295)
bones/38/rotation = Quaternion(-0.0140967, -0.706969, 0.165601, 0.687439)
bones/39/position = Vector3(-0.0437046, -0.045372, -0.275312)
bones/39/rotation = Quaternion(0.468104, 0.541792, -0.52998, 0.454381)
bones/40/position = Vector3(0.246517, -0.586248, -0.323822)
bones/41/position = Vector3(0.108825, -1.02128, -0.26542)
bones/41/rotation = Quaternion(0.195586, 0.808102, -0.155724, 0.533355)
bones/42/position = Vector3(0.0462875, -1.17626, -0.294563)
bones/43/position = Vector3(-0.10377, -0.045372, 0.288808)
bones/43/rotation = Quaternion(0.514351, 0.471896, -0.485225, 0.526606)
bones/44/position = Vector3(0.246517, -0.586248, 0.32303)
bones/45/position = Vector3(0.127258, -1.01428, 0.265936)
bones/45/rotation = Quaternion(0.0912114, 0.53513, -0.163882, 0.823686)
bones/46/position = Vector3(0.0462874, -1.17626, 0.294563)

[node name="character-wynn" parent="character-wynn/character-armature/Skeleton3D" index="0"]
layers = 2
gi_mode = 2
surface_material_override/0 = ExtResource("2_7jj0c")
surface_material_override/1 = ExtResource("3_1ou5g")
surface_material_override/2 = ExtResource("4_iaey1")

[node name="AnimationTree" type="AnimationTree" parent="."]
root_node = NodePath("../character-wynn")
tree_root = SubResource("AnimationNodeStateMachine_7l30x")
anim_player = NodePath("../character-wynn/AnimationPlayer")
parameters/wynn-idle/Blend/blend_amount = 0
parameters/wynn-kitchen-chopping/Blend/blend_amount = 0.0
parameters/wynn-kitchen-stirring/Blend/blend_amount = 0.0
parameters/wynn-run/Blend/blend_amount = 0.0
parameters/wynn-walk/Blend/blend_amount = 0

[node name="CharacterFootsteps" parent="." instance=ExtResource("2_eyfap")]

[node name="CharacterWaterArea" parent="." node_paths=PackedStringArray("characterFeetAudioNode") instance=ExtResource("6_fyx4p")]
characterFeetAudioNode = NodePath("../CharacterFootsteps")

[node name="Dialogue" type="AudioStreamPlayer3D" parent="."]
unit_size = 20.0
max_distance = 50.0
attenuation_filter_cutoff_hz = 20500.0
script = ExtResource("8_kl1hr")

[node name="TriggerArea" type="Area3D" parent="."]
collision_layer = 0
collision_mask = 128
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="TriggerArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 5.96046e-08, 0)
shape = SubResource("SphereShape3D_jrfpl")

[editable path="character-wynn"]
