[gd_scene load_steps=35 format=3 uid="uid://ci5w021qks137"]

[ext_resource type="Script" path="res://C#/MobWasp/MobWasp.cs" id="1_vbe2t"]
[ext_resource type="PackedScene" uid="uid://dmttw1vyk6xy4" path="res://Models/mob-wasp.glb" id="2_blq1i"]
[ext_resource type="PackedScene" uid="uid://wiit04fu1oww" path="res://Prefabs/FX/FxWaspDeath.tscn" id="2_hegcd"]
[ext_resource type="Script" path="res://C#/Mob Tools/MobFaction.cs" id="2_xwl4h"]
[ext_resource type="Script" path="res://C#/Mob Tools/MobDetection.cs" id="3_muehp"]
[ext_resource type="AudioStream" uid="uid://bwgwc6b164o5b" path="res://Audio/mob-wasp-hit.wav" id="3_mvmjm"]
[ext_resource type="Material" uid="uid://jpvogfgug5bt" path="res://Materials/MobWasp.tres" id="3_rexv1"]
[ext_resource type="PackedScene" uid="uid://cyh65ty8moprq" path="res://Prefabs/Gibs/GibWaspAbdomen.tscn" id="6_k7c3p"]
[ext_resource type="Script" path="res://C#/GibsActivator.cs" id="6_nqxbr"]
[ext_resource type="PackedScene" uid="uid://brljsrtq78hv1" path="res://Prefabs/Gibs/GibWaspHead.tscn" id="7_hwvjs"]
[ext_resource type="PackedScene" uid="uid://b4iwcasvg6jw" path="res://Prefabs/Gibs/GibWaspMid.tscn" id="8_cmu72"]
[ext_resource type="PackedScene" uid="uid://dr67ajwiaqnkk" path="res://Prefabs/Gibs/GibWaspWingL.tscn" id="9_la8w6"]
[ext_resource type="PackedScene" uid="uid://cyp7usw06fqjr" path="res://Prefabs/Gibs/GibWaspWingR.tscn" id="10_633pr"]
[ext_resource type="AudioStream" uid="uid://130buoernvce" path="res://Audio/mob-wasp-fly.wav" id="13_yyjne"]
[ext_resource type="Script" path="res://C#/Common/AudioTools3d.cs" id="14_82ttd"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2wsol"]
animation = &"wasp-hover"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_uhqfs"]
animation = &"wasp-fly"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_at3lr"]
blend_point_0/node = SubResource("AnimationNodeAnimation_2wsol")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_uhqfs")
blend_point_1/pos = 1.0
min_space = 0.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_xo26i"]
animation = &"wasp-idle-flick"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_k1qqa"]
animation = &"wasp-idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_wyglw"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_05efs"]
advance_mode = 2
advance_condition = &"flick"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gxjw0"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_li2dj"]
states/Start/position = Vector2(269, 108)
states/wasp-idle/node = SubResource("AnimationNodeAnimation_k1qqa")
states/wasp-idle/position = Vector2(414, 108)
states/wasp-idle-flick/node = SubResource("AnimationNodeAnimation_xo26i")
states/wasp-idle-flick/position = Vector2(642, 108)
transitions = ["Start", "wasp-idle", SubResource("AnimationNodeStateMachineTransition_wyglw"), "wasp-idle", "wasp-idle-flick", SubResource("AnimationNodeStateMachineTransition_05efs"), "wasp-idle-flick", "wasp-idle", SubResource("AnimationNodeStateMachineTransition_gxjw0")]
graph_offset = Vector2(79, 22)

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_83ogc"]
animation = &"wasp-hit"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ceqyv"]
xfade_time = 0.1
advance_mode = 2
advance_condition = &"hit"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gvu1h"]
xfade_time = 0.2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_rbb6o"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_eejlt"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"fly"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7uqa8"]
xfade_time = 0.2
advance_mode = 2
advance_condition = &"land"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_wmtt0"]
states/End/position = Vector2(648, 86)
states/Fly/node = SubResource("AnimationNodeBlendSpace1D_at3lr")
states/Fly/position = Vector2(510, 86)
states/Idle/node = SubResource("AnimationNodeStateMachine_li2dj")
states/Idle/position = Vector2(359, 86)
states/Start/position = Vector2(226, 86)
states/wasp-hit/node = SubResource("AnimationNodeAnimation_83ogc")
states/wasp-hit/position = Vector2(510, 184)
transitions = ["Fly", "wasp-hit", SubResource("AnimationNodeStateMachineTransition_ceqyv"), "wasp-hit", "Fly", SubResource("AnimationNodeStateMachineTransition_gvu1h"), "Start", "Idle", SubResource("AnimationNodeStateMachineTransition_rbb6o"), "Idle", "Fly", SubResource("AnimationNodeStateMachineTransition_eejlt"), "Fly", "Idle", SubResource("AnimationNodeStateMachineTransition_7uqa8")]
graph_offset = Vector2(-22, 24)

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_h8hly"]

[sub_resource type="AnimationNodeStateMachinePlayback" id="AnimationNodeStateMachinePlayback_uv8l0"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_me2gy"]
radius = 0.2
height = 0.9

[node name="MobWasp" type="CharacterBody3D" node_paths=PackedStringArray("detection", "animation", "gibsActivator", "flyAudio", "miscAudio")]
collision_layer = 512
collision_mask = 529
motion_mode = 1
script = ExtResource("1_vbe2t")
detection = NodePath("Detection")
animation = NodePath("AnimationTree")
gibsActivator = NodePath("Gibs")
flyAudio = NodePath("FlyAudio")
miscAudio = NodePath("MiscAudio")
flySound = ExtResource("13_yyjne")
hitSound = ExtResource("3_mvmjm")
waspDeathFx = ExtResource("2_hegcd")
lookSpeed = 5.0

[node name="mob-wasp" parent="." instance=ExtResource("2_blq1i")]

[node name="Skeleton3D" parent="mob-wasp/mob-wasp-armature" index="0"]
bones/0/position = Vector3(1.36747e-18, 0.00918878, 0.00612585)
bones/0/rotation = Quaternion(-0.728808, 7.60191e-17, 8.09139e-17, 0.684719)
bones/1/rotation = Quaternion(0.704786, -0.0572382, 0.704786, -0.0572382)
bones/2/rotation = Quaternion(0.862094, 0.102021, 0.484627, -0.107341)
bones/3/position = Vector3(0.0456698, -0.0426703, -0.0687528)
bones/3/rotation = Quaternion(-0.566552, -0.420045, -0.376384, 0.600763)
bones/4/position = Vector3(0.0497234, 0.0585937, -0.0423115)
bones/4/rotation = Quaternion(-0.481057, -0.381598, -0.270711, 0.741406)
bones/5/rotation = Quaternion(0.767641, 0.159991, 0.52241, -0.334988)
bones/6/rotation = Quaternion(0.862758, -0.097602, -0.484888, -0.104909)
bones/7/position = Vector3(-0.0466191, -0.0426288, -0.0694092)
bones/7/rotation = Quaternion(-0.587852, 0.40073, 0.396995, 0.579863)
bones/8/position = Vector3(-0.0497234, 0.0559201, -0.0424758)
bones/8/rotation = Quaternion(-0.495758, 0.366858, 0.301152, 0.727287)
bones/9/rotation = Quaternion(0.762749, -0.179607, -0.514318, -0.34847)

[node name="mob-wasp2" parent="mob-wasp/mob-wasp-armature/Skeleton3D" index="0"]
surface_material_override/0 = ExtResource("3_rexv1")

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_wmtt0")
anim_player = NodePath("../mob-wasp/AnimationPlayer")
active = true
parameters/playback = SubResource("AnimationNodeStateMachinePlayback_h8hly")
parameters/conditions/fly = false
parameters/conditions/hit = false
parameters/conditions/land = false
parameters/Fly/blend_position = 0.0
parameters/Idle/playback = SubResource("AnimationNodeStateMachinePlayback_uv8l0")
parameters/Idle/conditions/flick = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 0, 0)
shape = SubResource("CapsuleShape3D_me2gy")

[node name="Faction" type="Node3D" parent="."]
script = ExtResource("2_xwl4h")

[node name="Detection" type="RayCast3D" parent="." node_paths=PackedStringArray("myFaction")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.17214)
enabled = false
target_position = Vector3(0, 0, -1)
collision_mask = 3
script = ExtResource("3_muehp")
myFaction = NodePath("../Faction")
pointBlankRangeSqr = 1.0

[node name="Gibs" type="Node3D" parent="."]
visible = false
script = ExtResource("6_nqxbr")
speed = 4.0
randomDirectionRadius = 3.0
maxRotationSpeed = 6.0

[node name="GibWaspAbdomen" parent="Gibs" instance=ExtResource("6_k7c3p")]
transform = Transform3D(1, 0, 0, 0, 0.719073, -0.694935, 0, 0.694935, 0.719073, 0, -0.178034, 0.265597)

[node name="GibWaspHead" parent="Gibs" instance=ExtResource("7_hwvjs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.082751, -0.24326)

[node name="GibWaspMid" parent="Gibs" instance=ExtResource("8_cmu72")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0874378, 0.00707321)

[node name="GibWaspWingL" parent="Gibs" instance=ExtResource("9_la8w6")]
transform = Transform3D(0.939693, 0, -0.34202, -0.0885213, 0.965926, -0.24321, 0.330366, 0.258819, 0.907673, -0.2, 0.126537, 0.157943)

[node name="GibWaspWingR" parent="Gibs" instance=ExtResource("10_633pr")]
transform = Transform3D(0.939693, 0, 0.34202, 0.0885213, 0.965926, -0.24321, -0.330366, 0.258819, 0.907673, 0.2, 0.127, 0.158)

[node name="FlyAudio" type="AudioStreamPlayer3D" parent="."]
max_distance = 30.0
max_polyphony = 2
script = ExtResource("14_82ttd")

[node name="MiscAudio" type="AudioStreamPlayer3D" parent="."]
max_distance = 30.0
max_polyphony = 2
script = ExtResource("14_82ttd")

[editable path="mob-wasp"]
